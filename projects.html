<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Orhun Ege Eker — Projects</title>
  <link rel="icon" type="image/png" href="media/favicon.png">
  <meta name="description" content="Projects of Orhun Ege Eker — Multidisciplinary Designer">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0c0c0e; --panel:#121215; --text:#f6f7fb; --muted:#aeb4c0; --border:#1f2126;
      --radius:20px; --radius-sm:10px; --shadow:0 14px 40px rgba(0,0,0,.45);
      --tilt:6; --scale:1.02;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    a{color:inherit;text-decoration:none}
    .container{max-width:1180px;margin:0 auto;padding:0 20px}

    header{position:sticky;top:0;z-index:50;background:rgba(12,12,14,.6);backdrop-filter:saturate(160%) blur(10px);border-bottom:1px solid var(--border)}
    nav{display:flex;align-items:center;justify-content:space-between;height:64px}
    .brand{font-weight:800;letter-spacing:.4px;font-size:16px}
    .navlinks{display:flex;gap:20px;font-size:14px}
    .navlinks a{opacity:.85;position:relative}
    .navlinks a:after{content:"";position:absolute;left:0;right:0;bottom:-6px;height:2px;background:#2b2d33;transform:scaleX(0);transform-origin:left;transition:transform .25s ease}
    .navlinks a:hover{opacity:1}
    .navlinks a:hover:after{transform:scaleX(1)}

    .hero{padding:56px 0 8px}
    .hero h1{font-size:clamp(30px,4.2vw,44px);margin:0 0 10px;line-height:1.1;font-weight:800}
    .hero .sub{font-size:clamp(20px,3.2vw,28px);margin:0 0 8px;color:var(--text)}
    .desc{color:var(--muted);font-size:14px;max-width:820px}

    .grid{display:grid;gap:18px;margin:30px 0 0;grid-template-columns:repeat(1,minmax(0,1fr))}
    @media(min-width:720px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media(min-width:1040px){.grid{grid-template-columns:repeat(3,1fr)}}
    .card{display:block;border:1px solid var(--border);background:var(--panel);border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow);
          transform-style:preserve-3d;position:relative;transition:transform .32s cubic-bezier(.2,.7,.2,1), border-color .32s, box-shadow .32s}
    .card:hover{border-color:#2b2d33;box-shadow:0 18px 52px rgba(0,0,0,.55)}
    .media{position:relative;aspect-ratio:16/10;overflow:hidden}
    .media img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;transform:translateZ(30px) scale(1);transition:transform .5s ease}
    .card:hover .media img{transform:translateZ(30px) scale(1.04)}
    .badge{position:absolute;left:12px;top:12px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.16);backdrop-filter:blur(6px);font-size:11px;padding:6px 8px;border-radius:999px;transform:translateZ(35px)}
    .glare{pointer-events:none;position:absolute;inset:-1px;border-radius:inherit;overflow:hidden}
    .glare::before{content:"";position:absolute;left:var(--gx,50%);top:var(--gy,50%);width:90%;height:90%;
      background:radial-gradient(circle at center, rgba(255,255,255,.20), rgba(255,255,255,.06) 45%, rgba(255,255,255,0) 60%);
      transform:translate(-50%, -50%) rotate(var(--grot,0deg));filter:blur(16px);opacity:.9;transition:opacity .32s ease}
    .meta{display:flex;align-items:center;justify-content:space-between;padding:12px 14px}
    .title{font-weight:600}
    .tag{font-size:12px;color:#c8cdd8}

    #detail{display:none}
    .crumbs{font-size:13px;color:#cbd5e1;margin:18px 0}
    .back-btn{display:inline-block;padding:8px 14px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.15);border-radius:8px;font-size:14px;color:#fff;text-decoration:none;transition:background .25s ease,border-color .25s ease}
    .back-btn:hover{background:rgba(255,255,255,.12);border-color:rgba(255,255,255,.25)}
    .detail-hero{position:relative;border:1px solid var(--border);border-radius:var(--radius);aspect-ratio:16/9;background:#0f1013;overflow:hidden}
    .detail-hero img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
    .detail-title{margin:16px 0 6px;font-size:clamp(22px,3.4vw,36px);font-weight:800}
    .detail-tag{font-size:13px;color:#cbd5e1}
    .detail-desc{color:#d1d6df;line-height:1.7;margin-top:10px}
    .section-title{margin:18px 0 8px;font-size:16px;color:#cbd5e1;font-weight:600}
    .detail-video{border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;aspect-ratio:16/9;background:#0f0f10}
    .detail-video iframe,.detail-video video{width:100%;height:100%;border:0;display:block}

    /* Görsel yön duyarlılığı */
    .gif-grid img,.gallery img{
      width:100%;height:100%;object-fit:cover;border-radius:10px;border:1px solid var(--border);aspect-ratio:16/9;cursor:zoom-in;
    }
    .gif-grid img.portrait,.gallery img.portrait{object-fit:contain;aspect-ratio:3/4;background:#0f1013}

    footer{border-top:1px solid var(--border);margin-top:44px}
    footer .inner{padding:22px 0;color:#cbd5e1;font-size:14px;text-align:center}

    body.custom-cursor{cursor:none}
    .cursor-dot{position:fixed;left:0;top:0;width:20px;height:20px;border-radius:50%;
      pointer-events:none;transform:translate(-50%, -50%);background:rgba(255,255,255,0.18);
      box-shadow:0 0 18px rgba(255,255,255,0.75), 0 0 48px rgba(255,255,255,0.35);
      mix-blend-mode:screen;backdrop-filter:blur(2px);z-index:1000}
    .cursor-trail{position:fixed;left:0;top:0;width:8px;height:8px;border-radius:50%;pointer-events:none;transform:translate(-50%, -50%) scale(1);
      background:rgba(255,255,255,0.2);z-index:999;opacity:.9;animation:trailFade .5s ease-out forwards;box-shadow:0 0 14px rgba(255,255,255,.65);will-change:transform,opacity}
    @keyframes trailFade{to{transform:translate(-50%, -50%) scale(0);opacity:0}}
    a,button,[role="button"],.card{cursor:pointer}
    body.cursor-pointer .cursor-dot{width:26px;height:26px;background:rgba(255,255,255,0.12);box-shadow:0 0 24px rgba(255,255,255,0.9),0 0 60px rgba(255,255,255,0.45);outline:2px solid rgba(255,255,255,0.6);outline-offset:2px}
    @media(hover:none){body.custom-cursor{cursor:auto}.cursor-dot{display:none!important}}
    @media(prefers-reduced-motion:reduce){body.custom-cursor{cursor:auto}.cursor-dot,.cursor-trail{display:none!important}}

    /* Video tıklanmasın */
    .detail-video video, .detail-video iframe{ pointer-events:none; }

    /* ---- Lightbox ---- */
    .lightbox{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.78);backdrop-filter:blur(4px);z-index:90}
    .lightbox.show{display:flex}
    .lightbox-img{max-width:92vw;max-height:92vh;border-radius:12px;border:1px solid rgba(255,255,255,.2);background:#0b0f1c}
    .lb-btn{position:fixed;top:50%;transform:translateY(-50%);padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.25);background:rgba(20,24,34,.55);color:#fff;font-weight:700;cursor:pointer}
    .lb-prev{left:20px}.lb-next{right:20px}
    .lb-close{position:fixed;top:18px;right:18px;padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.25);background:rgba(20,24,34,.55);cursor:pointer}
  </style>
</head>
<body>
  <div class="cursor-dot" id="cursorDot" aria-hidden="true"></div>

  <header>
    <div class="container">
      <nav>
        <a class="brand" href="/">ORHUN EGE EKER</a>
        <div class="navlinks">
          <a href="/">SPACE</a>
          <a href="projects.html">PROJECTS</a>
          <a href="about.html">ABOUT</a>
          <a href="contact.html">CONTACT</a>
        </div>
      </nav>
    </div>
  </header>

  <main class="container" id="top">
    <section class="hero">
      <h1>Orhun Ege Eker</h1>
      <p class="sub">Multidisciplinary Designer</p>
      <p class="desc">TouchDesigner • 3D Works • Graphic Editing • Unreal Engine • Creative Visuals</p>
    </section>

    <div id="list">
      <section id="work">
        <div class="grid" id="grid"></div>
      </section>
    </div>

    <div id="detail">
      <div class="crumbs"><a href="projects.html" id="backLink" class="back-btn">← Back to Projects</a></div>
      <div class="detail-hero"><img id="detailCover" alt="cover"></div>
      <div class="detail-title" id="detailTitle"></div>
      <div class="detail-tag" id="detailTag"></div>
      <div class="detail-desc" id="detailDesc"></div>
      <div class="section-title">Video</div>
      <div class="detail-video" id="detailVideo" aria-label="Project video"></div>

      <div class="section-title" id="gifTitle">GIF Previews</div>
      <div class="gif-grid" id="detailGifs" style="display:grid;gap:12px;grid-template-columns:repeat(2,1fr)"></div>

      <div class="section-title" id="galleryTitle">Image Gallery</div>
      <div class="gallery" id="detailGallery" style="display:grid;gap:14px;grid-template-columns:repeat(3,1fr)"></div>
    </div>
  </main>

  <footer>
    <div class="container inner">© <span id="y"></span> Orhun Ege Eker</div>
  </footer>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox" aria-hidden="true">
    <button class="lb-close" id="lbClose" type="button">✕</button>
    <button class="lb-btn lb-prev" id="lbPrev" type="button">←</button>
    <img class="lightbox-img" id="lbImg" alt="">
    <button class="lb-btn lb-next" id="lbNext" type="button">→</button>
  </div>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    // ---- DATA LOAD (covers pX.jpg sabit) ----
    async function loadProjects(){
      const res = await fetch('/projects.json?cb=' + Date.now(), { cache: 'no-store' });
      const arr = await res.json();
      return arr.map(p => {
        const coverFromCovers = `media/covers/${p.id}.jpg`;
        return {
          ...p,
          media: { cover: coverFromCovers, video: p.video, gifs: p.gifs, images: p.images },
          desc: p.description ?? p.desc ?? ''
        };
      });
    }

    const listEl = document.getElementById('list');
    const detailEl = document.getElementById('detail');
    const gridEl = document.getElementById('grid');

    function showList(){ detailEl.style.display='none'; listEl.style.display='block'; }
    function getSlugFromURL(){ const url = new URL(window.location.href); return url.searchParams.get('p') || null; }
    function navigateTo(slug){
      if(slug){ history.pushState({p:slug}, '', `?p=${slug}`); renderDetail(slug); }
      else { history.pushState({}, '', 'projects.html'); showList(); window.scrollTo({top:0,behavior:'instant'}); }
    }

    let PROJECTS = [];
    init();
    async function init(){
      PROJECTS = await loadProjects();
      renderGrid(PROJECTS);
      const initial = getSlugFromURL(); if(initial){ renderDetail(initial); }
    }

    function renderGrid(items){
      gridEl.innerHTML='';
      const cb = Date.now();
      items.forEach((p,idx)=>{
        const a=document.createElement('a');
        a.className='card'; a.href=`?p=${p.id}`;
        const coverSrc = p.media.cover || `media/covers/${p.id}.jpg`;
        a.innerHTML=`
          <div class="media">
            <img src="${coverSrc}?cb=${cb}" alt="${p.title}" loading="lazy"
                 onerror="this.src='https://picsum.photos/seed/${p.id||idx}/1200/800'">
            <span class="badge">${p.tag||''}</span>
            <div class="glare"></div>
          </div>
          <div class="meta"><span class="title">${p.title}</span><span class="tag">${p.tag||''}</span></div>
        `;
        gridEl.appendChild(a);
      });

      // tilt + glare
      if (window.matchMedia('(hover: hover)').matches) {
        const clamp = (v,min,max)=>Math.max(min,Math.min(max,v));
        const maxTilt = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--tilt')) || 6;
        const scale = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--scale')) || 1.02;

        document.querySelectorAll('.card').forEach(card => {
          const media = card.querySelector('.media');
          const glare = card.querySelector('.glare');

          function onMove(e){
            const r = media.getBoundingClientRect();
            const cx = (e.clientX ?? (e.touches && e.touches[0].clientX)) - r.left;
            const cy = (e.clientY ?? (e.touches && e.touches[0].clientY)) - r.top;
            const px = cx / r.width, py = cy / r.height;
            const rx = ((0.5 - py) * 2) * maxTilt;
            const ry = ((px - 0.5) * 2) * maxTilt;
            card.style.transform = `rotateX(${rx}deg) rotateY(${ry}deg) scale(${scale})`;
            if(glare){
              const gx = clamp(px*100, 5, 95);
              const gy = clamp(py*100, 5, 95);
              glare.style.setProperty('--gx', gx + '%');
              glare.style.setProperty('--gy', gy + '%');
              glare.style.setProperty('--grot', (px*20-10).toFixed(2) + 'deg');
            }
          }
          function onEnter(){ card.style.willChange='transform'; }
          function onLeave(){ card.style.removeProperty('transform'); card.style.willChange=''; }

          media.addEventListener('pointermove', onMove);
          media.addEventListener('pointerenter', onEnter);
          media.addEventListener('pointerleave', onLeave);
        });
      }
    }

    // ---- Lightbox state ----
    const lb = document.getElementById('lightbox');
    const lbImg = document.getElementById('lbImg');
    const lbPrev = document.getElementById('lbPrev');
    const lbNext = document.getElementById('lbNext');
    const lbClose = document.getElementById('lbClose');
    let LB_ITEMS = [];
    let LB_INDEX = 0;

    function openLightbox(i){
      if(!LB_ITEMS.length) return;
      LB_INDEX = i;
      lbImg.src = LB_ITEMS[LB_INDEX];
      lb.classList.add('show');
      lb.setAttribute('aria-hidden','false');
    }
    function closeLightbox(){
      lb.classList.remove('show');
      lb.setAttribute('aria-hidden','true');
      lbImg.src = '';
    }
    function nextLB(){ if(!LB_ITEMS.length) return; LB_INDEX = (LB_INDEX+1)%LB_ITEMS.length; lbImg.src = LB_ITEMS[LB_INDEX]; }
    function prevLB(){ if(!LB_ITEMS.length) return; LB_INDEX = (LB_INDEX-1+LB_ITEMS.length)%LB_ITEMS.length; lbImg.src = LB_ITEMS[LB_INDEX]; }

    lbNext.addEventListener('click', nextLB);
    lbPrev.addEventListener('click', prevLB);
    lbClose.addEventListener('click', closeLightbox);
    lb.addEventListener('click', (e)=>{ if(e.target===lb) closeLightbox(); });
    window.addEventListener('keydown', (e)=>{
      if(lb.classList.contains('show')){
        if(e.key==='Escape') closeLightbox();
        else if(e.key==='ArrowRight') nextLB();
        else if(e.key==='ArrowLeft') prevLB();
      }
    });

    function renderDetail(slug){
      const p = PROJECTS.find(x=>x.id===slug); if(!p){ return showList(); }
      const coverSrc = p.media.cover || `media/covers/${p.id}.jpg`;
      document.getElementById('detailCover').src = coverSrc + '?cb=' + Date.now();
      document.getElementById('detailTitle').textContent = p.title;
      document.getElementById('detailTag').textContent = p.tag || '';
      document.getElementById('detailDesc').textContent = p.desc || 'Açıklama gelecek...';

     // ---- Video (autoplay+loop, tıklanamaz) ----
const v = document.getElementById('detailVideo'); v.innerHTML='';
if (p.media.video){
  if (/\.(mp4|webm)$/i.test(p.media.video)){
    const vid = document.createElement('video');
    vid.autoplay = true;
    vid.loop = true;
    vid.playsInline = true;
    vid.src = p.media.video;

    // varsayılan: sessiz
    vid.muted = true;

    // Sadece p2'de sesi aç
    if (p.id === 'p2') {
      vid.muted = false;
      vid.volume = 1.0;
      // bazı tarayıcılar sesli autoplay'i engeller — mümkünse dene:
      vid.addEventListener('canplay', () => {
        vid.play().catch(()=>{/* sessiz engel durumunda hata yut */});
      });
      // kullanıcı ilk etkileşiminde tekrar dene (engel kalkar)
      const oncePlay = () => { vid.play().catch(()=>{}); window.removeEventListener('click', oncePlay); };
      window.addEventListener('click', oncePlay, { once: true });
    }

    v.appendChild(vid);
  } else {
    // YouTube/Vimeo vb. için
    const sep = p.media.video.includes('?') ? '&' : '?';
    // varsayılan: mute=1, p2'de mute=0 dene (platform destekliyorsa)
    const muteParam = (p.id === 'p2') ? 'mute=0' : 'mute=1';
    const url = p.media.video + sep + `autoplay=1&${muteParam}&loop=1&playsinline=1`;
    const iframe = document.createElement('iframe');
    iframe.src = url;
    iframe.allow = 'autoplay; fullscreen; picture-in-picture';
    v.appendChild(iframe);
  }
} else {
  v.innerHTML = '<div style="display:flex;align-items:center;justify-content:center;height:100%;opacity:.6">No video</div>';
}
      // ---- GIFS (sınırsız + orientation + lightbox) ----
      const gifWrap = document.getElementById('detailGifs');
      const gifTitle = document.getElementById('gifTitle');
      gifWrap.innerHTML='';
      // ---- GALLERY (sınırsız + orientation + lightbox) ----
      const gal = document.getElementById('detailGallery');
      const galTitle = document.getElementById('galleryTitle');
      gal.innerHTML='';

      const gifs = Array.isArray(p.media.gifs) ? p.media.gifs : [];
      const imgs = Array.isArray(p.media.images) ? p.media.images : [];

      // Lightbox listesi: görsel sırası = önce GIF’ler sonra JPG’ler
      LB_ITEMS = [...gifs, ...imgs];

      if(gifs.length){
        gifTitle.style.display = '';
        gifWrap.style.display = 'grid';
        gifs.forEach((src, i) => {
          const img = new Image();
          img.onload = ()=>{ if(img.naturalHeight > img.naturalWidth) img.classList.add('portrait'); else img.classList.add('landscape'); };
          img.src = src; img.loading='lazy';
          img.addEventListener('click', ()=> openLightbox(i)); // ilk kısımda
          gifWrap.appendChild(img);
        });
      } else { gifTitle.style.display = 'none'; gifWrap.style.display = 'none'; }

      if(imgs.length){
        galTitle.style.display = '';
        gal.style.display = 'grid';
        imgs.forEach((src, i) => {
          const img = new Image();
          img.onload = ()=>{ if(img.naturalHeight > img.naturalWidth) img.classList.add('portrait'); else img.classList.add('landscape'); };
          img.src = src; img.loading='lazy';
          // Lightbox indexinde GIF’lerin ardından geldiği için offset ekle
          img.addEventListener('click', ()=> openLightbox(gifs.length + i));
          gal.appendChild(img);
        });
      } else { galTitle.style.display = 'none'; gal.style.display = 'none'; }

      listEl.style.display='none'; detailEl.style.display='block'; window.scrollTo({top:0,behavior:'instant'});
    }

    document.addEventListener('click',(e)=>{
      const a = e.target.closest('a.card');
      if(a && a.href.includes('?p=')){ e.preventDefault(); const slug=new URL(a.href).searchParams.get('p'); navigateTo(slug); }
    });
    document.getElementById('backLink').addEventListener('click', (e)=>{ e.preventDefault(); navigateTo(null); });

    // Custom cursor
    (function(){
      const hover = window.matchMedia('(hover: hover)').matches;
      const reduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if(!hover || reduced) return;
      document.body.classList.add('custom-cursor');
      const dot = document.getElementById('cursorDot');
      let x=0,y=0,rafId=null; const live=new Set(); const max=60;

      function move(e){
        x=e.clientX; y=e.clientY;
        if(!rafId){ rafId=requestAnimationFrame(()=>{ dot.style.left=x+'px'; dot.style.top=y+'px'; rafId=null; }); }
        spawn(x,y);
      }
      function spawn(px,py){
        if(live.size>=max){ const d=live.values().next().value; if(d){live.delete(d); d.remove();} }
        const p=document.createElement('div'); p.className='cursor-trail';
        const s=6+Math.random()*6; p.style.width=s+'px'; p.style.height=s+'px';
        p.style.left=px+'px'; p.style.top=py+'px';
        p.style.boxShadow='0 0 '+(10+Math.random()*12)+'px rgba(255,255,255,.7)';
        document.body.appendChild(p); live.add(p);
        p.addEventListener('animationend',()=>{live.delete(p); p.remove();},{once:true});
      }
      document.addEventListener('pointermove', move, {passive:true});
      document.addEventListener('pointerover', e => document.body.classList.toggle('cursor-pointer', !!e.target.closest('a,button,[role="button"]')), {passive:true});
      document.addEventListener('pointerout',  ()=> document.body.classList.remove('cursor-pointer'), {passive:true});
      window.addEventListener('pointerdown', ()=>{ dot.style.transform='translate(-50%, -50%) scale(0.85)'; });
      window.addEventListener('pointerup',   ()=>{ dot.style.transform='translate(-50%, -50%) scale(1)'; });
    })();
  </script>
</body>
</html>
